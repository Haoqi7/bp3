{#if $check_login#}
{#$admin_url|redirect#}
{#/if #}

<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>登录 | {#$app_name#}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    {#$favicon#}

    {#'/css/bootstrap.min.css'|addCss#}
    {#'/css/bootstrap-dialog.min.css'|addCss#}
    {#'/css/general.css'|addCss#}
    {#'/fonts/font-awesome-4.7.0/css/font-awesome.min.css'|addCss#}


    {#'/js/jquery.min.js'|addJs#}
    {#'/js/bootstrap.min.js'|addJs#}
    {#'/js/functions.js'|addJs#}
    {#'/js/bootstrap-dialog.min.js'|addJs#}

</head>
<body style="background-image: url('{#$base_url#}/static/img/login.png'); min-height: 700px;">
<div id="content">
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="./">{#$app_name#}</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li><a href="./">首页<i class="fa fa-home"></i></a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li class="active"><a href="{#$base_url|cat:'/login.php'#}">登录<i class="fa fa-user-circle-o" aria-hidden="true"></i></a></li>
                {#if $app_blog#}<li><a href="{#$app_blog#}">官博<i class="fa fa-rss"></i></a></li>{#/if#}
                {#if $app_github#}<li><a href="{#$app_github#}">github<i class="fa fa-github" aria-hidden="true"></i></a></li>{#/if#}
                {#if $config['control']['open_session']#}<li><a href="{#$base_url|cat:'/user/login.php'#}">免部署版<i class="fa fa-info-circle" aria-hidden="true"></i></a></li>{#/if#}
            </ul>

        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>
<div class="row mx-4 divColumnCenter">
        <form id="mainForm" method="post" class="form-horizontal">
            <div class="col-xs-12 col-md-4 col-md-push-4" style="background-color:white;">
                <div class="modal-header mb-4">
                    <h4 class="modal-title" id="myModalLabel"><span style="color:#1890ff">登录</span> <span class="pull-right fs-4"><a href="#" class="text-muted">注册 <i class="fa fa-caret-right" aria-hidden="true"></i></a></span></h4>
                </div>
                <div class="modal-body mb-4" id="model-body">
                    <div class="input-group mb-5">
                        <span class="input-group-addon" style="min-width:80px;"><i class="fa fa-user" aria-hidden="true"></i> 账户：</span>
                        <input type="text" class="form-control" required="" name="user" placeholder="用户名">
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon" style="min-width:80px;"><i class="fa fa-lock" aria-hidden="true"></i> 密码：</span>
                        <input type="password" required="" class="form-control" name="pwd" placeholder="密码">
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="pb-5 text-muted">
                        <span class="pull-left cursor-pointer">注册</span>
                        <span class="cursor-pointer">忘记密码</span>
                    </div>
                    <div>
                        <button class="form-control btn btn-primary" style="background-color:#409eff;color:#ffffff">登录</button>
                    </div>
                    <div class="text-center pt-4">
                        <svg style="vertical-align:bottom;cursor:pointer;" t="1671213705233" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1797" width="24" height="24"><path d="M721.470952 470.273089c4.394674-17.578697 7.325139-35.157394 7.325139-55.666555 0-117.191995-96.682834-212.408574-213.874829-212.408574-117.191995 0-213.874829 95.218624-213.874829 212.408574 0 19.042907 2.930464 36.621604 7.325139 52.736091-23.437581 11.719813-49.805627 46.877207-64.455904 92.288159-17.578697 60.06123-10.253558 117.191995 17.578697 125.981343 16.114487 4.394674 35.157394-5.858884 51.271881-26.368046 8.789349 17.578697 19.042907 35.157394 32.22693 51.271881-33.693184 8.789349-57.130765 29.29851-57.130765 52.736091 0 33.693184 46.877207 61.52544 104.007972 61.52544 42.482533 0 80.568346-16.114487 95.218624-38.087858 10.253558 1.46421 19.042907 2.930464 27.832255 2.930464 8.789349 0 17.578697-1.46421 27.832255-2.930464 14.648233 21.973371 52.736091 38.087858 95.218624 38.087858 57.130765 0 104.007972-27.832255 104.007972-61.52544 0-23.437581-23.437581-43.946743-57.130765-52.736091 11.719813-14.648233 21.973371-30.76272 30.76272-46.877207 14.648233 17.578697 32.22693 26.368046 46.877207 21.973371 27.832255-8.789349 35.157394-65.920114 17.578697-125.981343C765.417694 517.148251 743.444323 483.457112 721.470952 470.273089z" fill="#56B6E7" p-id="1798"></path><path d="M873.818296 150.926079C781.530137 58.63792 652.620374 1.507154 511.990798 1.507154S242.451459 58.63792 150.163299 150.926079C57.87514 243.214238 0.744375 372.124001 0.744375 512.753577c0 142.093786 57.130765 269.539339 149.418925 361.827498 92.288159 92.288159 221.197922 149.418925 361.827498 149.418925s269.539339-57.130765 361.827498-149.418925c92.288159-92.288159 149.418925-219.733713 149.418925-361.827498C1023.23722 372.124001 966.106455 243.214238 873.818296 150.926079zM831.337808 832.100588c-82.034601 82.034601-194.829877 133.304437-319.344966 133.304437s-237.31241-51.271881-319.344966-133.304437c-82.034601-80.568346-133.304437-194.829877-133.304437-319.344966s51.271881-237.31241 133.304437-319.344966 194.829877-133.304437 319.344966-133.304437 237.31241 51.271881 319.344966 133.304437 133.304437 194.829877 133.304437 319.344966S913.370364 751.532241 831.337808 832.100588z" fill="#56B6E7" p-id="1799"></path></svg>
                        <svg style="vertical-align:bottom;cursor:pointer;" t="1671213783146" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1577" width="24" height="24"><path d="M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024z m0-32a480 480 0 1 0 0-960 480 480 0 0 0 0 960zM414.336 634.24c-27.904 0-50.048-5.76-77.952-11.52l-77.952 38.4 22.08-66.368C224.704 556.288 192 506.24 192 444.608 192 338.752 292.096 256 414.336 256c108.736 0 204.992 66.432 224.192 155.904-6.72-0.96-14.4-0.96-21.12-0.96-105.92 0-188.672 78.912-188.672 176.128 0 16.384 2.88 31.744 6.784 46.208-7.68 0-14.464 0.96-21.184 0.96z m325.248 77.952l16.384 55.808-60.608-33.664c-22.144 5.76-44.288 11.52-66.432 11.52-105.856 0-188.608-72.192-188.608-160.704 0-88.576 82.752-160.704 188.608-160.704 100.096 0 188.608 72.128 188.608 160.64 0 49.152-32.64 93.44-77.952 127.104zM305.536 381.12a34.624 34.624 0 1 0 69.312 0 34.624 34.624 0 0 0-69.312 0z m154.944-0.96a34.624 34.624 0 1 0 69.312 0 34.624 34.624 0 0 0-69.312 0zM547.2 535.04a24.064 24.064 0 1 0 48.128 0 24.064 24.064 0 0 0-48.128 0z m122.24 1.984a24.064 24.064 0 1 0 48.128 0 24.064 24.064 0 0 0-48.128 0z" fill="#7bc549" p-id="1578"></path></svg>
                        <svg onclick="baidu_login()" style="vertical-align:bottom;cursor:pointer;" t="1671286625253" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2435" width="24" height="24"><path d="M442.368 525.312V583.68h-47.104s-47.104 4.096-63.488 57.344c-5.12 35.84 5.12 57.344 7.168 61.44 2.048 4.096 16.384 30.72 55.296 37.888h88.064V526.336l-39.936-1.024z m-1.024 179.2h-35.84s-25.6-1.024-32.768-29.696c-3.072-12.288 1.024-26.624 3.072-32.768 2.048-6.144 10.24-19.456 27.648-25.6h37.888v88.064zM604.16 587.776v113.664h-40.96s-14.336-2.048-16.384-13.312v-101.376l-41.984 1.024v112.64s2.048 28.672 41.984 38.912h101.376V587.776H604.16z" fill="#56B6E7" p-id="2436"></path><path d="M512 48.128C258.048 48.128 53.248 253.952 53.248 507.904s204.8 458.752 458.752 458.752 458.752-205.824 458.752-458.752c0-252.928-204.8-459.776-458.752-459.776z m23.552 223.232c4.096-37.888 49.152-95.232 84.992-87.04s67.584 55.296 61.44 96.256c-6.144 40.96-38.912 94.208-89.088 88.064-50.176-6.144-61.44-52.224-57.344-97.28zM430.08 167.936c37.888 0 68.608 44.032 68.608 97.28 0 54.272-30.72 97.28-68.608 97.28-36.864 0-67.584-44.032-68.608-97.28 0-54.272 30.72-97.28 68.608-97.28zM217.088 398.336s8.192-79.872 63.488-84.992c44.032-4.096 76.8 44.032 79.872 71.68 2.048 18.432 11.264 100.352-57.344 114.688-67.584 14.336-93.184-64.512-86.016-101.376z m521.216 345.088c-36.864 88.064-174.08 41.984-174.08 41.984s-50.176-16.384-108.544-3.072c-59.392 13.312-109.568 8.192-109.568 8.192s-68.608 2.048-88.064-84.992c-19.456-87.04 68.608-134.144 74.752-142.336s51.2-38.912 80.896-88.064c29.696-49.152 117.76-88.064 179.2 8.192C638.976 548.864 716.8 609.28 716.8 609.28s59.392 45.056 21.504 134.144z m-12.288-201.728c-74.752 2.048-77.824-50.176-77.824-88.064 0-39.936 8.192-95.232 68.608-95.232s76.8 59.392 76.8 78.848c0 19.456 8.192 103.424-67.584 104.448z" fill="#56B6E7" p-id="2437"></path></svg>
                        <svg style="vertical-align:bottom;cursor:pointer;" t="1671213814589" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1731" width="24" height="24"><path d="M512 64.050782c60.495816 0 119.153774 11.836583 174.345794 35.181267 53.335742 22.558785 101.245915 54.864562 142.401244 96.01989s73.461105 89.066525 96.01989 142.401244c23.344684 55.19202 35.181267 113.851001 35.181267 174.345794 0 60.494793-11.836583 119.153774-35.181267 174.345793-22.558785 53.334719-54.864562 101.245915-96.01989 142.401244s-89.066525 73.461105-142.401244 96.019891c-55.19202 23.344684-113.851001 35.181267-174.345794 35.181267s-119.153774-11.836583-174.345794-35.181267c-53.335742-22.558785-101.245915-54.864562-142.401244-96.019891S121.791857 739.679489 99.233072 686.34477c-23.344684-55.19202-35.181267-113.851001-35.181267-174.345793 0-60.495816 11.836583-119.153774 35.181267-174.345794 22.558785-53.335742 54.864562-101.245915 96.01989-142.401244s89.066525-73.461105 142.401244-96.01989c55.19202-23.344684 113.849978-35.181267 174.345794-35.181267m0-51.16531c-275.653107 0-499.114528 223.461421-499.114528 499.114528S236.346893 1011.114528 512 1011.114528s499.114528-223.461421 499.114528-499.114528S787.653107 12.885472 512 12.885472z" fill="#ff763b" p-id="1732"></path><path d="M452.817086 700.608635c-89.671299 4.198625-162.15617-40.772612-162.15617-100.603279 0-59.897182 72.483848-107.944478 162.15617-112.084774 89.719394-4.131087 162.356738 32.840966 162.356738 92.62763 0 59.835783-72.636321 115.995851-162.356738 120.060423M643.748626 506.21218c-21.310352-4.131087-10.949376-15.59928-10.949376-15.59928s20.834514-34.351366-4.131087-59.316967c-30.940686-30.930453-106.111736 3.939729-106.111736 3.939729-28.712949 8.905834-21.113877-4.074805-17.053398-26.15059 0-26.012444-8.905834-70.061682-85.405135-44.045145-76.400041 26.146497-142.008294 117.785613-142.008295 117.785613-45.632293 60.871369-39.58046 107.924012-39.58046 107.924012 11.381212 103.894232 121.763205 132.405589 207.614501 139.157363 90.333378 7.083326 212.227566-31.136138 249.202689-109.646236 36.960797-78.661547-30.215162-109.782336-51.577703-114.048499" fill="#ff763b" p-id="1733"></path><path d="M465.35054 600.659249c-5.715165 4.26514-12.744255 3.679809-15.739472-1.444908-3.151783-4.976338-1.971911-12.970406 3.795442-17.169032 6.67912-4.979408 13.637602-3.544733 16.646122 1.444909 3.00852 5.105275 0.853437 12.771885-4.702092 17.169031m-53.175083 45.281299c-16.842597 1.981121-30.41266-7.724938-30.41266-21.823028 0-14.016225 12.06785-28.708855 28.91454-30.464849 19.332301-1.842974 31.917944 9.31004 31.917943 23.391757 0.001023 14.020318-13.649881 26.995841-30.419823 28.89612m22.748097-118.553093c-90.175789 10.55131-79.758532 95.027284-79.758532 95.027284s-0.925069 26.755364 24.179702 40.373523c52.767807 28.588105 107.090017 11.285021 134.560672-24.174586 27.456329-35.45449 11.337209-121.720226-78.981842-111.226221M687.653579 469.64331c7.269567 0 13.441127-5.382591 14.491039-12.384052a6.51846 6.51846 0 0 0 0.183172-1.578961c11.015891-99.028411-81.135902-81.984223-81.135902-81.984223-8.190543 0-14.740726 6.617721-14.740726 14.874779 0 8.129144 6.550183 14.749936 14.740726 14.749936 66.197678-14.614859 51.577702 51.573609 51.577702 51.573609-0.001023 8.18952 6.67912 14.748912 14.883989 14.748912" fill="#ff763b" p-id="1734"></path><path d="M676.915004 296.783357c-31.865755-7.461949-64.62895-1.022283-73.827449 0.73371-0.700965 0.072655-1.373277 0.734734-2.015914 0.872881-0.322341 0.057305-0.518816 0.384763-0.518816 0.384763-9.05933 2.557242-15.666818 10.945283-15.666818 20.844747 0 11.793604 9.562796 21.496593 21.491477 21.496593 0 0 11.607362-1.555425 19.462261-4.635577 7.797593-3.133364 73.798796-2.336208 106.572224 52.714596 17.892509 40.171931 7.869225 67.067488 6.625907 71.389933 0 0-4.260024 10.432607-4.260023 20.715811 0 11.866259 9.562796 19.322068 21.423938 19.322068 9.899464 0 18.229177-1.362021 20.652366-18.113543h0.12382c35.19764-117.296473-43.054585-172.410722-100.062973-185.725982" fill="#ff763b" p-id="1735"></path></svg>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<footer id="footer" class="copyright">
    <div class="navbar navbar-default navbar-inverse">
        <p class="text-center" style="color:#9d9d9d;margin-top:15px;">Copyright © {#$app_name#} {#$year#}</p>
    </div>
</footer>
<style>
    .divColumnCenter{
        position: absolute;
        top: 45%;
        transform: translate(0,-45%);
    }

    .copyright,.navbar-inverse{
        margin-bottom: 0px;
        border: 0px;
    }
</style>
<script>
    $(function () {
        const height = $("#footer").height();
        $("#content").css("min-height",(document.documentElement.clientHeight-height)+'px');
    })
    function baidu_login(){

        let login_url = "{#$login_baidu_url#}";
        let errMsg = "";
        if(!login_url){
            errMsg =  "您还未配置百度账户，无法使用此功能";
        }
        if(errMsg){
            BootstrapDialog.show({
                title: '消息',
                message: "管理员："+errMsg,
                closable: true,
                closeByBackdrop: false,
                closeByKeyboard: false,
                buttons: [{
                    label: '关闭消息',
                    action: function(dialogRef){
                        dialogRef.close();
                    }
                }]
            });
        }else{
            location.href = login_url;
        }
    }
    //提交表单
    let disable = false;
    $("#mainForm").submit(function () {
        event.preventDefault();
        $("button.login").prop("disabled", true);
        if(disable){
            return false; 
        }else{
            disable = true;
        }
        $.ajax({
            url : "api/ajax.php?module=system&method=login",
            type : "GET",
            xhrFields : {
                withCredentials : true
            },
            data : $(this).serialize(),
            dataType: "jsonp",
            success : function(r){
                $("button.login").prop("disabled", false);
                disable = false;
                if(r.error_code){
                    error_message(r.info);
                }
                else{
                    success_message(r.info);
                    let query = getQuery();
                    //指定了重定向地址
                    if(query['redirect']){
                        easy_load(query['redirect']);
                    }
                    //刷新页面，后端自动重定向到用户首页
                    else{
                        lazy_reload(200);
                    }
                }
            }
        });
    });
</script>
</body>
</html>